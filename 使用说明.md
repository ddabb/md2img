# Md2Image 使用说明

## 简介

Md2Image 是一个 .NET 工具库，用于将 Markdown 文件渲染为图片，支持自定义模板，方便在各种场景下使用，特别适合微信公众号等不支持直接粘贴富文本的平台。

## 安装

### 作为库使用

```bash
dotnet add package Md2Image
```

### 作为命令行工具使用

```bash
dotnet tool install --global Md2Image.Cli
```

## 命令行使用

基本用法：

```bash
md2image -i 输入文件.md -o 输出目录
```

完整选项：

```bash
md2image -i 输入文件.md -o 输出目录 -t 模板名称 --width 800 --max-height 1200 --format png --quality 90 --title "文档标题" --author "作者名称" --watermark "水印文本"
```

查看可用模板：

```bash
md2image --list-templates
```

## 编程方式使用

```csharp
using Md2Image.Core;

// 创建转换器实例
var converter = new MarkdownConverter();

// 设置转换选项
var options = new ConversionOptions
{
    TemplateName = "wechat", // 使用微信风格模板
    Width = 800,
    MaxHeight = 1200,
    Format = ImageFormat.Png,
    Variables = new TemplateVariables
    {
        Title = "文档标题",
        Author = "作者名称",
        Date = DateTime.Now
    },
    AddWatermark = true,
    WatermarkText = "水印文本"
};

// 转换并保存图片
var outputFiles = await converter.ConvertFileAndSaveAsync(
    "input.md", // 输入文件
    "output", // 输出目录
    "output_prefix", // 输出文件名前缀
    options);

// 输出生成的图片文件路径
foreach (var file in outputFiles)
{
    Console.WriteLine(file);
}
```

## 自定义模板

Md2Image 支持自定义 HTML 模板。模板使用 Scriban 模板引擎，可以访问以下变量：

- `title`：文档标题
- `author`：文档作者
- `date`：文档日期
- `content`：Markdown 渲染后的 HTML 内容
- `watermark_text`：水印文本（如果启用）

您可以创建自己的 HTML 模板文件，并通过 `--custom-template` 选项或 `CustomTemplatePath` 属性指定。

## 测试结果展示

您可以在 `test_results` 目录中查看不同模板的渲染效果示例。该目录包含了使用各种模板（默认、微信、抖音、小红书）渲染同一Markdown文件的效果对比。

详细的测试结果说明请参阅 `test_results/测试结果说明.md`。

## 注意事项

1. 当前版本的 HTML 渲染功能是模拟实现，在实际应用中，您需要替换为真实的 HTML 渲染实现。
2. 对于长文档，工具会自动分页，生成多张图片。
3. 默认提供了四种模板：`default`、`wechat`、`douyin` 和 `xiaohongshu`。